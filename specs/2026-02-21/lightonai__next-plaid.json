{
  "schema_version": 3,
  "app": {
    "name": "ColGREP",
    "one_liner": "Semantic code search for your terminal and coding agents that combines regex filtering with semantic ranking, all running locally."
  },
  "screens": [
    {
      "name": "Main Terminal Interface",
      "purpose": "Allow users to perform semantic+regex code searches directly in the terminal after initializing a project index.",
      "primary_actions": [
        "Automatically update index on file changes",
        "Initialize project index with `colgrep init`",
        "Run semantic+regex search queries"
      ]
    }
  ],
  "rust_commands": [
    {
      "name": "init",
      "purpose": "Builds the initial semantic index for a specified project directory or current working directory.",
      "async": false,
      "input": {
        "content_hash": "string",
        "file_path": "string",
        "last_modified": "string",
        "semantic_vector": "string"
      },
      "output": {
        "message": "string",
        "ok": "boolean"
      }
    },
    {
      "name": "install_claude_code",
      "purpose": "Installs ColGREP integration for Claude Code plugin.",
      "async": false,
      "input": {
        "content_hash": "string",
        "file_path": "string",
        "last_modified": "string",
        "semantic_vector": "string"
      },
      "output": {
        "message": "string",
        "ok": "boolean"
      }
    },
    {
      "name": "install_codex",
      "purpose": "Installs ColGREP integration for Codex plugin.",
      "async": false,
      "input": {
        "content_hash": "string",
        "file_path": "string",
        "last_modified": "string",
        "semantic_vector": "string"
      },
      "output": {
        "message": "string",
        "ok": "boolean"
      }
    },
    {
      "name": "install_opencode",
      "purpose": "Installs ColGREP integration for OpenCode plugin.",
      "async": false,
      "input": {
        "content_hash": "string",
        "file_path": "string",
        "last_modified": "string",
        "semantic_vector": "string"
      },
      "output": {
        "message": "string",
        "ok": "boolean"
      }
    },
    {
      "name": "search",
      "purpose": "Performs combined regex and semantic search on indexed codebase, updating index if files changed.",
      "async": false,
      "input": {
        "filters": "json",
        "limit": "int",
        "offset": "int"
      },
      "output": {
        "items": "json",
        "total": "int"
      }
    }
  ],
  "data_model": {
    "tables": [
      {
        "name": "indexed_files",
        "columns": [
          {
            "name": "content_hash",
            "type": "TEXT"
          },
          {
            "name": "file_path",
            "type": "TEXT"
          },
          {
            "name": "last_modified",
            "type": "DATETIME"
          },
          {
            "name": "semantic_vector",
            "type": "JSON"
          }
        ]
      },
      {
        "name": "project_index",
        "columns": [
          {
            "name": "created_at",
            "type": "DATETIME"
          },
          {
            "name": "index_version",
            "type": "TEXT"
          },
          {
            "name": "project_root",
            "type": "TEXT"
          }
        ]
      }
    ]
  },
  "mvp_plan": [
    "week 1: Build file change detection and incremental reindexing",
    "week 1: Implement core indexing logic using ONNX-based semantic model",
    "week 1: Integrate regex preprocessing with BRE-to-ERE conversion",
    "week 1: Package as single Rust binary with no external dependencies"
  ],
  "acceptance_tests": [
    "ColGREP must handle files opened elsewhere without erroring out during indexing or search.",
    "ColGREP must successfully index a project on Apple Silicon macOS without crashing (exit code 101).",
    "Running `colgrep init` inside a hidden directory must correctly index all eligible files.",
    "Unbalanced group escapes in regex input must not produce invalid ERE during query processing."
  ]
}
