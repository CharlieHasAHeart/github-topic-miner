{
  "schema_version": 3,
  "app": {
    "name": "iloom",
    "one_liner": "A developer workflow system delivered as a CLI and VS Code extension for structured AI-assisted development that persists analysis, plans, and decisions to your issue tracker."
  },
  "screens": [
    {
      "name": "Main Workflow Screen",
      "purpose": "Orchestrate AI-assisted development tasks including planning, implementation, and review within isolated workflows.",
      "primary_actions": [
        "List project issues and PRs with `il issues`",
        "Review and manage active looms via VS Code extension",
        "Start a new task with `il start`"
      ]
    }
  ],
  "rust_commands": [
    {
      "name": "il_cleanup",
      "purpose": "Clean up local branches associated with completed or obsolete looms without failing on draft PR branches.",
      "async": true,
      "input": {
        "completeness_score": "string",
        "gaps_detected": "string",
        "loom_id": "string",
        "reviewer_agent": "string"
      },
      "output": {
        "message": "string",
        "ok": "boolean"
      }
    },
    {
      "name": "il_issues",
      "purpose": "List open issues and non-draft pull requests from configured issue trackers (GitHub or Linear), with caching for performance.",
      "async": true,
      "input": {
        "filters": "json",
        "limit": "int",
        "offset": "int"
      },
      "output": {
        "items": "json",
        "total": "int"
      }
    },
    {
      "name": "il_start",
      "purpose": "Initiate a new AI-assisted development task, optionally creating a draft PR with linked issue context.",
      "async": true,
      "input": {
        "completeness_score": "string",
        "gaps_detected": "string",
        "loom_id": "string",
        "reviewer_agent": "string"
      },
      "output": {
        "message": "string",
        "ok": "boolean"
      }
    },
    {
      "name": "il_vscode",
      "purpose": "Install and manage the iloom VS Code extension to enable real-time AI insight panels and loom exploration.",
      "async": true,
      "input": {
        "completeness_score": "string",
        "gaps_detected": "string",
        "loom_id": "string",
        "reviewer_agent": "string"
      },
      "output": {
        "message": "string",
        "ok": "boolean"
      }
    }
  ],
  "data_model": {
    "tables": [
      {
        "name": "artifact_reviews",
        "columns": [
          {
            "name": "completeness_score",
            "type": "REAL"
          },
          {
            "name": "gaps_detected",
            "type": "JSON"
          },
          {
            "name": "loom_id",
            "type": "TEXT"
          },
          {
            "name": "reviewer_agent",
            "type": "TEXT"
          }
        ]
      },
      {
        "name": "issue_tracker_cache",
        "columns": [
          {
            "name": "items",
            "type": "JSON"
          },
          {
            "name": "last_fetched",
            "type": "DATETIME"
          },
          {
            "name": "project_key",
            "type": "TEXT"
          }
        ]
      },
      {
        "name": "loom_tasks",
        "columns": [
          {
            "name": "branch_name",
            "type": "TEXT"
          },
          {
            "name": "draft_pr_url",
            "type": "TEXT"
          },
          {
            "name": "id",
            "type": "TEXT"
          },
          {
            "name": "issue_context",
            "type": "JSON"
          },
          {
            "name": "parent_loom_id",
            "type": "TEXT"
          }
        ]
      }
    ]
  },
  "mvp_plan": [
    "week 1: Build local caching layer for issue/PR metadata",
    "week 1: Enable VS Code extension installation via `il vscode`",
    "week 1: Implement core CLI commands: `il start`, `il issues`, `il cleanup`",
    "week 1: Integrate draft PR creation with issue context embedding"
  ],
  "acceptance_tests": [
    "Child loom draft PRs correctly target the parent loom's branch instead of main to support stacked PR workflows.",
    "Draft PRs created during `il start` include full issue title, body, and 'Fixes #XXX' keyword for auto-closure on merge.",
    "Running `il issues` lists open GitHub/Linear issues and non-draft PRs, caches results for 2 minutes, and prefixes PRs with [PR].",
    "The `il cleanup` command successfully deletes local branches even when associated with draft PRs.",
    "User can run `il start` on an unconfigured project and accept sensible defaults with one keypress."
  ]
}
